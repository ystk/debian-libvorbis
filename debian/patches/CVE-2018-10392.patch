Index: libvorbis-1.3.2/lib/vorbisenc.c
===================================================================
--- libvorbis-1.3.2.orig/lib/vorbisenc.c	2010-03-26 07:20:51.000000000 +0100
+++ libvorbis-1.3.2/lib/vorbisenc.c	2019-11-27 16:02:26.611211473 +0100
@@ -685,6 +685,7 @@
   highlevel_encode_setup *hi=&ci->hi;
 
   if(ci==NULL)return(OV_EINVAL);
+  if(vi->channels<1||vi->channels>255)return(OV_EINVAL);
   if(!hi->impulse_block_p)i0=1;
 
   /* too low/high an ATH floater is nonsensical, but doesn't break anything */
